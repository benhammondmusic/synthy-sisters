<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
  <link rel="apple-touch-icon" href="icon.png">
  <link rel="icon" type="image/png" href="icon.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Monoton&family=Rock+Salt&family=Creepster&family=Eater&display=swap"
    rel="stylesheet">
  <title>SynthySisters</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      font-family: system-ui, -apple-system, sans-serif;
      overflow-x: hidden;
      overflow-y: auto;
      transition: background 0.5s ease;
    }

    body.unicorn-mode {
      background: linear-gradient(135deg, #a78bfa 0%, #f9a8d4 50%, #93c5fd 100%);
    }

    body.witch-mode {
      background: linear-gradient(135deg, #1a0033 0%, #2d1b4e 30%, #0d3d2e 60%, #1a0033 100%);
    }

    #initial-warning {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 300;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #initial-warning.hidden {
      display: none;
    }

    #initial-warning-content {
      background: white;
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 0 50px rgba(0, 0, 0, 0.3);
      max-width: 90%;
      width: 400px;
      text-align: center;
    }

    #initial-warning h3 {
      font-family: "Rock Salt", cursive;
      color: #59008c;
      margin-bottom: 20px;
      font-size: 20px;
    }

    #initial-warning p {
      color: #333;
      font-size: 16px;
      line-height: 1.6;
      margin-bottom: 20px;
    }

    #initial-warning button {
      padding: 15px 40px;
      font-size: 18px;
      background: linear-gradient(135deg, #a78bfa 0%, #f9a8d4 100%);
      color: white;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-weight: bold;
      touch-action: manipulation;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }

    #initial-warning button:active {
      transform: scale(0.95);
    }

    #user-name {
      font-size: clamp(40px, 4vw, 60px);
      text-align: center;
      margin: 20px 50px;
      font-family: "Rock Salt", cursive;
      font-weight: 700;
      letter-spacing: 8px;
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    #user-name:hover {
      transform: scale(1.05);
    }

    body.witch-mode #user-name {
      font-family: "Creepster", cursive;
    }

    #user-name span {
      display: inline-block;
      text-shadow: 3px 3px 0px rgba(0, 0, 0, 0.1), 0 0 20px currentColor;
      animation: float 2s ease-in-out infinite;
      margin: 0 2px;
    }

    body.unicorn-mode #user-name span:nth-child(1) {
      color: #ff6b9d;
      animation-delay: 0s;
    }

    body.unicorn-mode #user-name span:nth-child(2) {
      color: #ffa07a;
      animation-delay: 0.1s;
    }

    body.unicorn-mode #user-name span:nth-child(3) {
      color: #ffd700;
      animation-delay: 0.2s;
    }

    body.unicorn-mode #user-name span:nth-child(4) {
      color: #98fb98;
      animation-delay: 0.3s;
    }

    body.unicorn-mode #user-name span:nth-child(5) {
      color: #87ceeb;
      animation-delay: 0.4s;
    }

    body.witch-mode #user-name span:nth-child(1) {
      color: #7fff00;
      animation-delay: 0s;
    }

    body.witch-mode #user-name span:nth-child(2) {
      color: #9d4edd;
      animation-delay: 0.1s;
    }

    body.witch-mode #user-name span:nth-child(3) {
      color: #ff6d00;
      animation-delay: 0.2s;
    }

    body.witch-mode #user-name span:nth-child(4) {
      color: #00ff41;
      animation-delay: 0.3s;
    }

    body.witch-mode #user-name span:nth-child(5) {
      color: #c77dff;
      animation-delay: 0.4s;
    }

    @keyframes float {

      0%,
      100% {
        transform: translateY(0px);
      }

      50% {
        transform: translateY(-10px);
      }
    }

    @keyframes drift {

      0%,
      100% {
        transform: translateY(0px) translateX(0px);
      }

      50% {
        transform: translateY(-15px) translateX(10px);
      }
    }

    body.witch-mode #user-name span {
      animation: drift 3s ease-in-out infinite;
    }

    @keyframes bounce {

      0%,
      100% {
        transform: translateY(0px) scale(1);
      }

      50% {
        transform: translateY(-20px) scale(1.1);
      }
    }

    #user-name.bounce span {
      animation: bounce 0.6s ease;
    }

    #piano {
      position: relative;
      width: 95%;
      max-width: 1000px;
      margin: 0 auto;
    }

    .white-key {
      height: 192px;
      background: rgb(248, 212, 255);
      border: 2px solid #1f2937;
      border-radius: 0 0 8px 8px;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      cursor: pointer;
      position: relative;
      z-index: 1;
      transition: all 0.1s ease;
      touch-action: manipulation;
    }

    body.witch-mode .white-key {
      background: #2d1b4e;
      border: 2px solid #000;
    }

    .black-key {
      height: 128px;
      background: #59008c;
      border: 2px solid #030712;
      border-radius: 0 0 8px 8px;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      cursor: pointer;
      position: absolute;
      z-index: 2;
      pointer-events: auto;
      transition: all 0.1s ease;
      touch-action: manipulation;
    }

    body.witch-mode .black-key {
      background: #0d3d2e;
      border: 2px solid #000;
    }

    @media screen and (max-width: 700px) {
      #piano {
        width: 100%;
      }

      .white-key {
        height: 160px;
      }

      .black-key {
        height: 106px;
      }

      .white-key span {
        font-size: 8px;
        bottom: 10px;
      }
    }

    #white-keys {
      display: flex;
      gap: 0;
    }

    .white-key:active,
    .white-key.pressed {
      background: hotpink;
      transform: translateY(2px);
      box-shadow: 0 5px 10px -3px rgba(0, 0, 0, 0.2);
    }

    body.witch-mode .white-key:active,
    body.witch-mode .white-key.pressed {
      background: #7fff00;
      box-shadow: 0 0 20px #00ff00;
    }

    .white-key span {
      position: absolute;
      bottom: 16px;
      left: 50%;
      transform: translateX(-50%);
      color: #4b5563;
      font-weight: 400;
      font-size: 10px;
      pointer-events: none;
      user-select: none;
      white-space: nowrap;
    }

    body.witch-mode .white-key span {
      color: #7fff00;
    }

    #black-keys {
      position: absolute;
      top: 0;
      left: 0;
      display: flex;
      gap: 0;
      pointer-events: none;
      width: 100%;
    }

    .black-key:active,
    .black-key.pressed {
      background: hotpink;
      transform: translateY(2px);
      box-shadow: 0 10px 15px -5px rgba(0, 0, 0, 0.2);
    }

    body.witch-mode .black-key:active,
    body.witch-mode .black-key.pressed {
      background: #ff6d00;
      box-shadow: 0 0 20px #ff6d00;
    }

    .mode-button {
      position: fixed;
      top: 10px;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      border: 2px solid rgba(255, 255, 255, 0.5);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      opacity: 0.8;
      transition: all 0.3s ease;
      z-index: 100;
      touch-action: manipulation;
    }

    .mode-button:hover {
      opacity: 1;
      background: rgba(255, 255, 255, 0.5);
      transform: scale(1.1);
    }

    .mode-button:active {
      transform: scale(0.9);
    }

    #unicorn-button {
      right: 10px;
    }

    #witch-button {
      right: 70px;
    }

    #settings-button {
      right: 130px;
    }

    #settings-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 0 50px rgba(0, 0, 0, 0.3);
      z-index: 200;
      max-width: 90%;
      width: 400px;
      display: none;
      text-align: center;
    }

    #settings-popup.show {
      display: block;
    }

    #settings-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 199;
      display: none;
    }

    #settings-overlay.show {
      display: block;
    }

    #settings-popup h3 {
      font-family: "Rock Salt", cursive;
      color: #59008c;
      margin-bottom: 20px;
      font-size: 20px;
    }

    body.witch-mode #settings-popup h3 {
      font-family: "Creepster", cursive;
      color: #7fff00;
    }

    #settings-popup p {
      color: #333;
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: 20px;
    }

    #settings-name-input {
      width: 100%;
      padding: 12px;
      font-size: 20px;
      border: 3px solid #a78bfa;
      border-radius: 12px;
      text-align: center;
      font-family: "Rock Salt", cursive;
      background: white;
      color: #ff1493;
      box-shadow: 0 0 10px rgba(167, 139, 250, 0.3);
      outline: none;
      margin-bottom: 20px;
    }

    body.witch-mode #settings-name-input {
      border: 3px solid #7fff00;
      font-family: "Eater", cursive;
      color: #2d1b4e;
      box-shadow: 0 0 10px rgba(127, 255, 0, 0.3);
    }

    #settings-popup button {
      padding: 12px 30px;
      font-size: 16px;
      background: linear-gradient(135deg, #a78bfa 0%, #f9a8d4 100%);
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-weight: bold;
      touch-action: manipulation;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
      margin: 5px;
    }

    body.witch-mode #settings-popup button {
      background: linear-gradient(135deg, #2d1b4e 0%, #0d3d2e 100%);
    }

    #settings-popup button:active {
      transform: scale(0.95);
    }

    #app-title {
      position: fixed;
      top: 10px;
      left: 10px;
      font-family: "Rock Salt", cursive;
      font-size: 12px;
      color: rgba(255, 255, 255, 0.6);
      z-index: 100;
      text-shadow: 0 0 5px rgba(255, 105, 180, 0.3);
    }

    body.witch-mode #app-title {
      font-family: "Creepster", cursive;
      color: rgba(127, 255, 0, 0.6);
      text-shadow: 0 0 5px rgba(0, 255, 0, 0.3);
    }

    .particle {
      position: fixed;
      pointer-events: none;
      z-index: 50;
      font-size: 24px;
      animation: particleFloat 4s ease-in-out infinite;
      opacity: 0.7;
    }

    @keyframes particleFloat {
      0% {
        transform: translateY(0) translateX(0) rotate(0deg);
        opacity: 0.7;
      }

      50% {
        transform: translateY(-30px) translateX(20px) rotate(180deg);
        opacity: 0.9;
      }

      100% {
        transform: translateY(0) translateX(0) rotate(360deg);
        opacity: 0.7;
      }
    }
  </style>
</head>

<body class="unicorn-mode">
  <div id="app-title">SynthySisters</div>

  <button id="unicorn-button" class="mode-button" title="Unicorn Mode">ü¶Ñ</button>
  <button id="witch-button" class="mode-button" title="Witch Mode">üßô‚Äç‚ôÄÔ∏è</button>
  <button id="settings-button" class="mode-button" title="Settings">‚öôÔ∏è</button>

  <div id="initial-warning">
    <div id="initial-warning-content">
      <h3>üîî Welcome!</h3>
      <p>If you're using an iOS device (iPhone/iPad), make sure your device is <strong>not in Silent Mode</strong> for
        sound to work!</p>
      <p>Check the physical switch on the side of your device.</p>
      <button id="initial-got-it">Got it! ‚ú®</button>
    </div>
  </div>

  <div id="settings-overlay"></div>
  <div id="settings-popup">
    <h3>‚öôÔ∏è Settings</h3>
    <p style="font-size: 12px; margin-bottom: 10px;"><strong>Your Name:</strong></p>
    <input type="text" id="settings-name-input" placeholder="Enter your name..." maxlength="12">
    <p style="font-size: 12px; margin-top: 20px; margin-bottom: 10px;"><strong>üîî Sound Not Working?</strong></p>
    <p>Make sure your iOS device isn't in Silent Mode! Check the physical switch on the side of your device.</p>
    <button id="save-settings">Save</button>
  </div>

  <div id="user-name"></div>

  <div id="piano">
    <div id="white-keys"></div>
    <div id="black-keys"></div>
  </div>

  <script>
    let audioContext = null;
    let currentUser = 'SYNTHY SISTERS';
    let currentMode = 'unicorn';
    let particles = [];

    const unicornEmojis = ['ü¶Ñ', 'üåà', '‚≠ê', 'üíñ', '‚ú®', 'üéÄ', 'üíù', 'üå∏', 'ü¶ã', 'üéµ'];
    const witchEmojis = ['üßô‚Äç‚ôÄÔ∏è', 'üéÉ', 'üëª', 'ü¶á', 'üï∑Ô∏è', 'üï∏Ô∏è', 'üîÆ', '‚ú®', 'üíÄ', 'üåô', '‚ö°', 'üßõ‚Äç‚ôÄÔ∏è', 'üßü‚Äç‚ôÄÔ∏è', 'üëπ', 'üë∫'];

    const keys = [
      { note: 'C3', freq: 261.63 },
      { note: 'C#3', freq: 277.18 },
      { note: 'D3', freq: 293.66 },
      { note: 'D#3', freq: 311.13 },
      { note: 'E3', freq: 329.63 },
      { note: 'F3', freq: 349.23 },
      { note: 'F#3', freq: 369.99 },
      { note: 'G3', freq: 392.00 },
      { note: 'G#3', freq: 415.30 },
      { note: 'A3', freq: 440.00 },
      { note: 'A#3', freq: 466.16 },
      { note: 'B3', freq: 493.88 },
      { note: 'C4', freq: 523.25 },
      { note: 'C#4', freq: 554.37 },
      { note: 'D4', freq: 587.33 },
      { note: 'D#4', freq: 622.25 },
      { note: 'E4', freq: 659.25 },
      { note: 'F4', freq: 698.46 },
      { note: 'F#4', freq: 739.99 },
      { note: 'G4', freq: 783.99 },
      { note: 'G#4', freq: 830.61 },
      { note: 'A4', freq: 880.00 },
      { note: 'A#4', freq: 932.33 },
      { note: 'B4', freq: 987.77 },
      { note: 'C5', freq: 1046.50 },
    ];

    // Initial warning
    document.getElementById('initial-got-it').addEventListener('click', function () {
      document.getElementById('initial-warning').classList.add('hidden');
      initializeApp();
    });

    document.getElementById('initial-warning').addEventListener('click', function (e) {
      if (e.target === this) {
        this.classList.add('hidden');
        initializeApp();
      }
    });

    function initializeApp() {
      if (!audioContext) {
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
        if (audioContext.state === 'suspended') {
          audioContext.resume();
        }
        const osc = audioContext.createOscillator();
        const gain = audioContext.createGain();
        gain.gain.value = 0;
        osc.connect(gain);
        gain.connect(audioContext.destination);
        osc.start();
        osc.stop(audioContext.currentTime + 0.001);
      }

      initPiano();
      createParticles();
      displayUserName(currentUser);
    }

    function createParticles() {
      particles.forEach(p => p.element.remove());
      particles = [];

      const emojis = currentMode === 'unicorn' ? unicornEmojis : witchEmojis;
      const particleCount = 15;

      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.textContent = emojis[Math.floor(Math.random() * emojis.length)];
        particle.style.left = Math.random() * 100 + '%';
        particle.style.top = Math.random() * 100 + '%';
        particle.style.animationDelay = Math.random() * 4 + 's';
        particle.style.animationDuration = (3 + Math.random() * 3) + 's';
        document.body.appendChild(particle);
        particles.push({ element: particle });
      }
    }

    function switchMode(mode) {
      currentMode = mode;
      document.body.className = mode + '-mode';
      createParticles();
      displayUserName(currentUser);
    }

    function displayUserName(name) {
      const userName = document.getElementById('user-name');
      userName.innerHTML = '';

      const displayName = name.toUpperCase();
      for (let i = 0; i < displayName.length; i++) {
        const span = document.createElement('span');
        span.textContent = displayName[i];
        userName.appendChild(span);
      }
    }

    function openSettings() {
      document.getElementById('settings-name-input').value = currentUser;
      document.getElementById('settings-overlay').classList.add('show');
      document.getElementById('settings-popup').classList.add('show');
    }

    function closeSettings() {
      document.getElementById('settings-overlay').classList.remove('show');
      document.getElementById('settings-popup').classList.remove('show');
    }

    document.getElementById('unicorn-button').addEventListener('click', function () {
      switchMode('unicorn');
    });

    document.getElementById('witch-button').addEventListener('click', function () {
      switchMode('witch');
    });

    document.getElementById('settings-button').addEventListener('click', openSettings);

    document.getElementById('user-name').addEventListener('click', openSettings);

    document.getElementById('save-settings').addEventListener('click', function () {
      const newName = document.getElementById('settings-name-input').value.trim();
      currentUser = newName || 'SYNTHY SISTERS';
      displayUserName(currentUser);
      closeSettings();
    });

    document.getElementById('settings-overlay').addEventListener('click', closeSettings);

    function playNote(frequency, button) {
      if (!audioContext) {
        return;
      }

      const userName = document.getElementById('user-name');
      userName.classList.remove('bounce');
      void userName.offsetWidth;
      userName.classList.add('bounce');

      try {
        button.classList.add('pressed');
        setTimeout(() => button.classList.remove('pressed'), 200);

        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();

        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);

        oscillator.frequency.value = frequency;
        oscillator.type = currentMode === 'witch' ? 'square' : 'sine';

        if (currentMode === 'witch') {
          const lfo = audioContext.createOscillator();
          const lfoGain = audioContext.createGain();

          lfo.frequency.value = 6;
          lfoGain.gain.value = 15;

          lfo.connect(lfoGain);
          lfoGain.connect(oscillator.frequency);

          lfo.start(audioContext.currentTime);
          lfo.stop(audioContext.currentTime + 0.8);
        }

        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.8);

        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.8);
      } catch (error) {
        console.error('Error playing note:', error);
      }
    }

    function initPiano() {
      const whiteKeysContainer = document.getElementById('white-keys');
      const blackKeysContainer = document.getElementById('black-keys');

      whiteKeysContainer.innerHTML = '';
      blackKeysContainer.innerHTML = '';

      let whiteKeyPosition = 0;

      const isNarrowScreen = window.innerWidth <= window.innerHeight;
      let keysToDisplay = keys;

      if (isNarrowScreen) {
        keysToDisplay = keys.slice(0, 13);
      }

      const TOTAL_WHITE_KEYS = keysToDisplay.filter((key) => !key.note.includes('#')).length;
      const WHITE_KEY_WIDTH_PERCENT = 100 / TOTAL_WHITE_KEYS;
      const BLACK_KEY_WIDTH_PERCENT = (WHITE_KEY_WIDTH_PERCENT * 2) / 3;

      keysToDisplay.forEach((key) => {
        const isSharp = key.note.includes('#');

        if (!isSharp) {
          const button = document.createElement('button');
          button.className = 'white-key';
          button.dataset.freq = key.freq;
          button.style.width = WHITE_KEY_WIDTH_PERCENT + '%';

          button.addEventListener('touchstart', function (e) {
            e.preventDefault();
            playNote(key.freq, button);
          }, { passive: false });

          button.addEventListener('click', function () {
            playNote(key.freq, button);
          });

          const span = document.createElement('span');
          span.textContent = key.note.charAt(0);
          button.appendChild(span);

          whiteKeysContainer.appendChild(button);
          whiteKeyPosition++;
        } else {
          const button = document.createElement('button');
          button.className = 'black-key';
          button.dataset.freq = key.freq;
          button.style.width = BLACK_KEY_WIDTH_PERCENT + '%';

          const leftPositionPercent = (whiteKeyPosition * WHITE_KEY_WIDTH_PERCENT) - (BLACK_KEY_WIDTH_PERCENT / 2);
          button.style.left = `${leftPositionPercent}%`;

          button.addEventListener('touchstart', function (e) {
            e.preventDefault();
            playNote(key.freq, button);
          }, { passive: false });

          button.addEventListener('click', function () {
            playNote(key.freq, button);
          });

          blackKeysContainer.appendChild(button);
        }
      });
    }

    let resizeTimer;
    window.addEventListener('resize', function () {
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(function () {
        initPiano();
      }, 200);
    });

    let lastPlayedKey = null;

    document.addEventListener('touchmove', function (e) {
      e.preventDefault();

      const touch = e.touches[0];
      const element = document.elementFromPoint(touch.clientX, touch.clientY);

      if (element && (element.classList.contains('white-key') || element.classList.contains('black-key'))) {
        const freq = parseFloat(element.dataset.freq);

        if (freq && element !== lastPlayedKey) {
          playNote(freq, element);
          lastPlayedKey = element;
        }
      }
    }, { passive: false });

    document.addEventListener('touchend', function () {
      lastPlayedKey = null;
    });

    switchMode('unicorn');
  </script>
</body>

</html>